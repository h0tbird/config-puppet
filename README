#------------------------------------------------------------------------------
# Enable forwarding of the authentication agent connection:
#------------------------------------------------------------------------------

ssh -A puppet01.domain

#------------------------------------------------------------------------------
# Clone the repository:
#------------------------------------------------------------------------------

git clone --recursive git@github.com:h0tbird/puppet.git /etc/puppet

#------------------------------------------------------------------------------
# Run puppet apply:
#------------------------------------------------------------------------------

FACTER_fqdn=puppet01.domain \
FACTER_domain=domain \
puppet apply \
--modulepath=/etc/puppet/modules:/etc/puppet/roles \
/etc/puppet/manifests/site.pp

#------------------------------------------------------------------------------
# Run puppet agent:
#------------------------------------------------------------------------------

puppet agent --test

#------------------------------------------------------------------------------
# Sign the certificate:
#------------------------------------------------------------------------------

puppet cert -s puppet01.domain

#------------------------------------------------------------------------------
# Create a new git sobmodule:
#------------------------------------------------------------------------------

git submodule add https://h0tbird@github.com/h0tbird/puppet-yum.git modules/yum
git push -u origin master

#------------------------------------------------------------------------------
# Delete a git submodule:
#------------------------------------------------------------------------------

1. Delete the relevant section from the .gitmodules file.
2. Delete the relevant section from .git/config.
3. Run git rm --cached path_to_submodule (no trailing slash).
4. Commit and delete the now untracked submodule files.

#------------------------------------------------------------------------------
# Update git submodule (stdlib) from upstream repo:
#------------------------------------------------------------------------------

git remote add upstream https://github.com/puppetlabs/puppetlabs-stdlib.git
git checkout master
git pull upstream master
git push origin master
