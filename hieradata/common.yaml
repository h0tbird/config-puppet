---

###############################################################################
## LISTS: To be referenced later on.
###############################################################################

#------------------------------------------------------------------------------
# Hosts:
#------------------------------------------------------------------------------

Hosts:
 localhost: &Host_localhost
  ip: '127.0.0.1'
  name: '%{hostname}.%{domain}'
  host_aliases:
   - '%{hostname}'
   - 'localhost.localdomain'
   - 'localhost'
 puppet: &Host_puppet
  ip: '192.168.1.4'
  name: 'puppet.%{domain}'
  host_aliases: 'puppet'
 cobbler: &Host_cobbler
  ip: '192.168.1.4'
  name: 'cobbler.%{domain}'
  host_aliases: 'cobbler'
 foreman: &Host_foreman
  ip: '192.168.1.4'
  name: 'foreman.%{domain}'
  host_aliases: 'foreman'

#------------------------------------------------------------------------------
# Ssh public keys:
#------------------------------------------------------------------------------

SshKeys:
 marc.villacorta: &SshKey_marc_villacorta 'AAAAB3NzaC1yc2EAAAADAQABAAABAQD4FtYAzzgjQWuR8yDa0XV+LGlUjuHvI9HXhAKGmkb2HsSNTcPOJmE5F1TxC761va4KRN+nTTJ5d1Ts+7TyupvmSJVM53I3nZBipCieF59uTQxFSFTTJbQh9+0EhhjFl5WL3tA8kgzlAC/ARAWiW0+GDVmo8IQ+RkKcNVebKbXHMH9lFzKxUmFN7pS7VfPOwxjEqZMEAnNb7K3adWQDf98w2qDQ2gfwDqbc45TiNf39+4OJIW4oPyvT9B/p0K6NGNu1SSct9uO+HDNuZlLcRd7yIbhL0IrcROHNwAmHxHo9Ki2G/mIoOCUyinLyg94XzW+D0QWIBN2oJA7CWOrr0TJn'
 deborah.aguilar: &SshKey_deborah_aguilar 'AAAB3NzaC1yc2EAAAADAQABAAABAQCVblqnZu6pnuHyIqrYIVfmIn4LLo98nQTcUiDTBuyo1k2fOeSlMz8tDIB0fZpyOaoTFASTIGF4pSNczNlv23kwYj5mIuctLmiNF0+VCEWeE0wj7LEA7s1/YXziKBczVkFhl06uPNQ/OHhEKy7LjPn9DTX2NFnWO00GQ+oyLhTMMe5O8OTmtT/ySNYhouhxR7jdMtOo4qw2wkGVXk123A+i1hCpvylUaS70MkM08he/q99pjT3f1VbZg6mw6bPXtM+de4RkkCFF3T53djy4Omil6yiAGODzVIVBXXUuZtU+YlsWtATac3Vs0nFcgujqMKRvvuMVy9/ZejLG4eQartzB'

#------------------------------------------------------------------------------
# Users:
#------------------------------------------------------------------------------

Users:
 marc.villacorta: &User_marc_villacorta
  linux:
   uid: '501'
   gid: '501'
   comment: 'Marc Villacorta'
   groups: 'puppet'
   pass: '!!'
   home: '/home/marc.villacorta'
   shell: '/bin/bash'
   key: *SshKey_marc_villacorta
  git:
   home: '/home/marc.villacorta'
   fullname: 'Marc Villacorta'
   email: 'marc.villacorta@gmail.com'
   editor: 'vim'
   difftool: 'vimdiff'
  samba:
   password: 'password'
 deborah.aguilar: &User_deborah_aguilar
  linux:
   uid: '502'
   gid: '502'
   comment: 'Deborah Aguilar'
   groups: 'puppet'
   pass: '!!'
   home: '/home/deborah.aguilar'
   shell: '/bin/bash'
   key: *SshKey_deborah_aguilar
  git:
   home: '/home/deborah.aguilar'
   fullname: 'Deborah Aguilar'
   email: 'dev@null.nop'
   editor: 'vim'
   difftool: 'vimdiff'
  samba:
   password: 'password'

#------------------------------------------------------------------------------
# YumRepos:
#------------------------------------------------------------------------------

YumRepos:
 centos_base: &YumRepo_centos_base
  name: 'CentOS-$releasever - Base'
  baseurl: "http://cobbler.%{domain}/cobbler/ks_mirror/CentOS_6-x86_64/\n
           http://mirror.centos.org/centos/$releasever/os/$basearch/"
  gpgkey: 'file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6'
  gpgcheck: '1'
  enabled: '1'
 centos_updates: &YumRepo_centos_updates
  name: 'CentOS-$releasever - Updates'
  baseurl: "http://cobbler.%{domain}/cobbler/repo_mirror/CentOS_6-x86_64-updates/\n
           http://mirror.centos.org/centos/$releasever/updates/$basearch/"
  gpgkey: 'file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6'
  gpgcheck: '1'
  enabled: '1'
 centos_extras: &YumRepo_centos_extras
  name: 'CentOS-$releasever - Extras'
  baseurl: "http://cobbler.%{domain}/cobbler/repo_mirror/CentOS_6-x86_64-extras/\n
           http://mirror.centos.org/centos/$releasever/extras/$basearch/"
  gpgkey: 'file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6'
  gpgcheck: '1'
  enabled: '1'
 epel: &YumRepo_epel
  name: 'Extra Packages for Enterprise Linux 6 - $basearch'
  baseurl: "http://cobbler.%{domain}/cobbler/repo_mirror/EPEL-el6-x86_64/\n
           http://download.fedoraproject.org/pub/epel/6/$basearch"
  failovermethod: 'priority'
  gpgcheck: '0'
  enabled: '1'
 epel_testing: &YumRepo_epel_testing
  name: 'Extra Packages for Enterprise Linux 6 - Testing - $basearch'
  baseurl: "http://cobbler.%{domain}/cobbler/repo_mirror/EPEL_testing-el6-x86_64/\n
           http://download.fedoraproject.org/pub/epel/testing/6/$basearch"
  failovermethod: 'priority'
  gpgcheck: '0'
  enabled: '1'
 puppetlabs_products: &YumRepo_puppetlabs_products
  name: 'Puppet Labs Products El 6 - $basearch'
  baseurl: "http://cobbler.%{domain}/cobbler/repo_mirror/puppetlabs-products-el6-x86_64/\n
           http://yum.puppetlabs.com/el/6/products/$basearch"
  gpgcheck: '0'
  enabled: '1'
 puppetlabs_deps: &YumRepo_puppetlabs_deps
  name: 'Puppet Labs Dependencies El 6 - $basearch'
  baseurl: "http://cobbler.%{domain}/cobbler/repo_mirror/puppetlabs-deps-el6-x86_64/\n
           http://yum.puppetlabs.com/el/6/dependencies/$basearch"
  gpgcheck: '0'
  enabled: '1'
 foreman: &YumRepo_foreman
  name: 'Foreman'
  baseurl: "http://cobbler.%{domain}/cobbler/repo_mirror/foreman-el6-x86_64/\n
           http://yum.theforeman.org/releases/latest/el6/$basearch"
  gpgcheck: '0'
  enabled: '1'
 percona: &YumRepo_percona
  name: 'Percona'
  baseurl: "http://cobbler.%{domain}/cobbler/repo_mirror/percona-el6-x86_64/\n
           http://repo.percona.com/centos/6/os/$basearch"
  gpgcheck: '0'
  enabled: '1'
 bitcoin: &YumRepo_bitcoin
  name: 'Bitcoin'
  baseurl: "http://cobbler.%{domain}/cobbler/repo_mirror/bitcoin-el6-x86_64/\n
           http://linux.ringingliberty.com/bitcoin/el6/$basearch"
  gpgcheck: '0'
  enabled: '1'

#------------------------------------------------------------------------------
# GitRepos:
#------------------------------------------------------------------------------

GitRepos:
 puppet: &GitRepo_puppet
  ensure: 'present'
  owner: 'root'
  group: 'puppet'
  mode: '0664'
  recursive: true
  server: 'github.com'
  user: 'h0tbird'
  path: '/etc/puppet'

###############################################################################
## ROLES: This data is feeded into role class parameters.
###############################################################################

#------------------------------------------------------------------------------
# r_base:
#------------------------------------------------------------------------------

# hosts
r_base::hosts:
 hosts:
  localhost: *Host_localhost
  puppet: *Host_puppet
  cobbler: *Host_cobbler
  foreman: *Host_foreman

# factsdotd:
r_base::factsdotd:
 hostgroup: true

# yum
r_base::yum:
 version: 'present'
 cachedir: '/var/cache/yum/$basearch/$releasever'
 keepcache: '0'
 debuglevel: '2'
 logfile: '/var/log/yum.log'
 exactarch: '1'
 obsoletes: '1'
 gpgcheck: '1'
 plugins: '1'
 installonly_limit: '5'
 distroverpkg: 'centos-release'
 repos:
  centos_base: *YumRepo_centos_base
  centos_updates: *YumRepo_centos_updates
  centos_extras: *YumRepo_centos_extras
  epel: *YumRepo_epel
  epel_testing: *YumRepo_epel_testing
  puppetlabs_products: *YumRepo_puppetlabs_products
  puppetlabs_deps: *YumRepo_puppetlabs_deps

# ntp
r_base::ntp:
 ensure: 'running'
 version: 'present'
 servers:
  - '0.centos.pool.ntp.org iburst'
  - '1.centos.pool.ntp.org iburst'
  - '2.centos.pool.ntp.org iburst'
 tickers:
  - '0.centos.pool.ntp.org'
  - '1.centos.pool.ntp.org'
  - '2.centos.pool.ntp.org'

# ssh
r_base::ssh:
 ensure: 'running'
 version: 'present'
 root_keys:
  marc.villacorta:
   key: *SshKey_marc_villacorta
  deborah.aguilar:
   key: *SshKey_deborah_aguilar

# puppet
r_base::puppet:
 ensure: 'running'
 version: 'present'

#------------------------------------------------------------------------------
# r_puppet:
#------------------------------------------------------------------------------

# users
r_puppet::users:
 marc.villacorta: *User_marc_villacorta
 deborah.aguilar: *User_deborah_aguilar

# repos
r_puppet::repos:
 puppet: *GitRepo_puppet

# samba
r_puppet::samba:
 ensure: 'running'
 version: 'present'
 workgroup: 'DEMO'
 server_string: 'Samba Server Version %v'
 netbios_name: "%{hostname}"
 interfaces: 'lo eth0'
 hosts_allow: '127. 192.168.'
 log_file: '/var/log/samba/%m.log'
 max_log_size: '50'
 security: 'user'
 passdb_backend: 'tdbsam'
 load_printers: 'no'
 shares:
  puppet:
   path: '/etc/puppet'
   comment: 'Puppet share.'
   valid_users:
    - 'marc.villacorta'
    - 'deborah.aguilar'

#------------------------------------------------------------------------------
# r_kvm:
#------------------------------------------------------------------------------

# libvirt
r_kvm::libvirt:
 ensure: 'running'
 version: 'present'
 listen_tls: '1'
 listen_tcp: '0'
 tls_port: '16514'
 tcp_port: '16509'
 listen_addr: "%{ipaddress}"
 mdns_adv: '0'
 mdns_name: "Virtualization Host %{hostname}"
 unix_sock_group: 'root'
 unix_sock_ro_perms: '0777'
 unix_sock_rw_perms: '0770'
 unix_sock_dir: '/var/run/libvirt'
 auth_unix_ro: 'none'
 auth_unix_rw: 'none'
 auth_tcp: 'sasl'
 auth_tls: 'none'

# kvm
r_kvm::kvm:
 version: 'present'
 ksm: 'running'
 ksmtuned: 'running'

# koan
r_kvm::koan:
 version: 'present'
 systems:
  frontend01:
   size: '4096'
   volume: 'vg0'
  backend01:
   size: '4096'
   volume: 'vg0'
  router01:
   size: '4096'
   volume: 'vg0'
  miner01:
   size: '15360'
   volume: 'vg0'

#------------------------------------------------------------------------------
# r_router:
#------------------------------------------------------------------------------

# pppd
r_router::pppd:
 ensure: 'running'
 version: 'present'
 ifaces:
  ppp0:
   userctl: 'no'
   bootproto: 'dialup'
   name: 'FTTH'
   device: 'ppp0'
   type: 'xDSL'
   onboot: 'yes'
   pidfile: '/var/run/pppoe-ftth.pid'
   firewall: 'none'
   ping: '.'
   pppoe_timeout: '120'
   lcp_failure: '3'
   lcp_interval: '20'
   clampmss: '1412'
   connect_poll: '6'
   connect_timeout: '60'
   defroute: 'yes'
   synchronous: 'no'
   eth: 'eth2'
   provider: 'ppp0'
   user: 'adslppp@telefonicanetpa'
   password: 'adslppp'
   peerdns: 'yes'
   demand: 'no'

# dhcp
r_router::dhcp:
 ensure: 'running'
 version: 'present'
 globals:
  - 'ddns-update-style interim'
  - 'allow booting'
  - 'allow bootp'
  - 'ignore client-updates'
  - 'set vendorclass = option vendor-class-identifier'
  - 'option pxe-system-type code 93 = unsigned integer 16'
 subnets:
  192.168.1.0:
   netmask: '255.255.255.0'
   domain_name: 'demo.lan'
   domain_name_servers: '192.168.1.1,8.8.8.8'
   routers: '192.168.1.1'
   subnet_mask: '255.255.255.0'
   ntp_servers: '192.168.1.1'
   default_lease_time: '21600'
   max_lease_time: '43200'
   range_dynamic_bootp: '192.168.1.200 192.168.1.250'

#------------------------------------------------------------------------------
# r_miner:
#------------------------------------------------------------------------------

# yum
r_miner::yum:
 version: 'latest'
 repos:
  bitcoin: *YumRepo_bitcoin
...
